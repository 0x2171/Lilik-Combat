<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <title>Lilik Enchantment</title>
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            text-align: center;
            background: linear-gradient(135deg, #000000, #191970);
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            color: #ffffff;
        }
        .name, h1, h3, #shareButton, #dailyBonus {
            color: #ffffff;
            font-size: 36px;
            margin-bottom: 20px;
            animation: textShadow 2s infinite;
        }
        #shareButton, #dailyBonus {
            position: relative;
            font-size: 16px;
            top: 15px;
            border-radius: 5px;
            background-color: rgba(255, 255, 255, 0.2);
            transition: background-color 0.3s, transform 0.3s;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            cursor: pointer;
        }
        #shareButton:hover, #dailyBonus:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
        }
        #shareButton:active, #dailyBonus:active {
            background-color: #00ffff;
            transform: scale(0.95);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        @keyframes textShadow {
            0% { text-shadow: 0 0 5px #00ffff; }
            50% { text-shadow: 0 0 10px #00ffff; }
            100% { text-shadow: 0 0 5px #00ffff; }
        }
        #coin {
            width: 534px;
            height: 534px;
            background-color: transparent;
            border-radius: 50%;
            margin: 80px auto;
            transform: scale(1.8);
            transition: transform 0.3s, box-shadow 0.3s;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            outline: none;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        #coin:active {
            animation: coinPress 0.3s;
        }
        @keyframes coinPress {
            0% {
                transform: scale(1.8);
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            }
            50% {
                transform: scale(1.7);
                box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            }
            100% {
                transform: scale(1.8);
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            }
        }
        #score, #upgscore, #nameupg {
            font-size: 28px;
            margin-top: 20px;
            color: #ffffff;
            background-color: rgba(255, 255, 255, 0.2);
            padding: 10px 20px;
            border-radius: 5px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            animation: textShadow 2s infinite;
        }
        #upgscore {
            position: fixed;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            flex-direction: column;
            align-items: center;
            font-size: 16px;
            max-width: 150px;
        }
        #nameupg {
            position: fixed;
            top: 10%;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            flex-direction: column;
            align-items: center;
            font-size: 26px;
        }
        #upgrades {
            max-width: 800px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .upgrade {
            margin: 8px;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 5px;
            background-color: rgba(255, 255, 255, 0.2);
            transition: background-color 0.3s, transform 0.3s;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            color: #ffffff;
            animation: textShadow 2s infinite;
        }
        .upgrade:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
        }
        .upgrade:active {
            background-color: #00ffff;
            transform: scale(0.95);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        @media (max-width: 600px) {
            h1 {
                font-size: 24px;
            }
            #coin {
                width: 110px;
                height: 110px;
            }
            #score {
                font-size: 20px;
                padding: 5px 10px;
            }
            .upgrade {
                padding: 10px;
                font-size: 14px;
            }
        }
        #resetButton {
            position: fixed;
            top: 1px;
            left: 0;
            margin-top: 0;
            padding: 1px;
            border: 1px solid #ccc;
            border-radius: 5px;
            background-color: rgba(255, 255, 255, 0.2);
            transition: background-color 0.3s, transform 0.3s;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            font-size: 10px;
            color: #ffffff;
            animation: textShadow 2s infinite;
            cursor: pointer;
        }
        #resetButton:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
        }
        #resetButton:active {
            background-color: #00ffff;
            transform: scale(0.95);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        .nav-buttons {
            position: fixed;
            bottom: 16px;
            display: flex;
            gap: 1px;
        }
        .nav-button {
            padding: 1px 20px;
            border: 1px solid #ccc;
            border-radius: 5px;
            background-color: rgba(255, 255, 255, 0.2);
            transition: background-color 0.3s, transform 0.3s;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            color: #ffffff;
            animation: textShadow 2s infinite;
            text-decoration: none;
        }
        .nav-button:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
        }
        .nav-button:active {
            background-color: #00ffff;
            transform: scale(0.95);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        .page {
            display: none;
        }
        .page.active {
            display: block;
        }
        #loading-screen {
           position: fixed;
           top: 0;
           left: 0;
           width: 100%;
           height: 100%;
           background-color: #000000;
           display: flex;
           flex-direction: column;
           justify-content: center;
           align-items: center;
           z-index: 999;
        }
        #loading-spinner {
           border: 16px solid #f3f3f3;
           border-top: 16px solid #00ffff;
           border-radius: 50%;
           width: 120px;
           height: 120px;
           animation: spin 2s linear infinite;
         }
         @keyframes spin {
             0% { transform: rotate(0deg); }
             100% { transform: rotate(360deg); }
         }
         .coin-effect {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 15px;
            color: white;
            animation: fadeOut 1s ease-in-out;
            pointer-events: none;
            cursor: none;
        }
        @keyframes fadeOut {
            0% { opacity: 1; transform: translate(100%, -100%) scale(1); }
            100% { opacity: 0; transform: translate(150%, -50%) scale(1.5); }
        }
        #progress-container {
            display: flex;
            align-items: center;
            margin-top: 20px;
        }
        #progress-bar {
            width: 200px;
            height: 20px;
            background-color: #ccc;
            border-radius: 5px;
            margin: 0 10px;
            position: relative;
        }
        #progress-bar-fill {
            height: 100%;
            background-color: #00ffff;
            border-radius: 5px;
            transition: width 0.3s;
        }
        #progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 12px;
        }
        #current-level, #next-level {
            color: #00ffff;
        }
        #airdrop-info {
            margin-top: 20px;
            font-size: 15px;
            color: #ffffff;
            background-color: rgba(255, 255, 255, 0.2);
            padding: 2px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            animation: textShadow 2s infinite;
        }
        #light-effect {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(0,255,255,0.6) 0%, rgba(0,255,255,0) 100%);
            opacity: 0;
            pointer-events: none;
            transition: opacity 1s ease-in-out;
        }
    </style>
</head>
<body>
    <div id="loading-screen">
        <div id="loading-spinner"></div>
        <h1>Loading</h1>
    </div>
    <div id="nav-place"></div>
    <div class="nav-buttons">
        <a href="#mine" class="nav-button">💠 Enchanting</a>
        <a href="#upgrade" class="nav-button">🌀 Upgrade</a>
        <a href="#airdrop" class="nav-button">🌙 Moondrop</a>
    </div>

    <div id="mine" class="page active">
        <div class="name">Lilik Enchantment</div>
        <div id="coin">
            <img src="https://raw.githubusercontent.com/0x2171/Lilik-Combat/refs/heads/main/images/u2b50_u1f48e.png" alt="Coin" style="width: 100%; height: 100%;">
        </div>
        <div id="score">Sparks: 0</div>
        <div id="progress-container">
            <div id="current-level">1</div>
            <div id="progress-bar">
                <div id="progress-bar-fill"></div>
                <div id="progress-text"></div>
            </div>
            <div id="next-level">2</div>
        </div>
        <div id="resetButton">Reset all progress</div>
        <div id="dailyBonus">Daily Bonus: Click to claim!</div>
    </div>

    <div id="upgrade" class="page">
        <div id="upgscore">Sparks: 0</div>
        <div id="upgrades">
            <div class="upgrade" id="upgrade1"></div>
            <div class="upgrade" id="upgrade2"></div>
            <div class="upgrade" id="upgrade3"></div>
            <div class="upgrade" id="upgrade4"></div>
        </div>
    </div>

    <div id="airdrop" class="page">
        <h1>Moondrop</h1>
        <h3>Listing Information</h3>
        <div id="airdrop-info">
            <p>Coin Name: Lilik Spark</p>
            <p>Ticker: LILIK</p>
            <p>Total Supply: 500 Telegram Stars</p>
            <p>Circulating Supply: NaN</p>
            <p>Moondrop Date: TBA</p>
            <p>Moondrop Amount: TBA</p>
        </div>
        <div id="shareButton">Share your progress</div>
    </div>

    <script>
        const tgwindow = window.Telegram.WebApp;
        tgwindow.isExpanded;
        tgwindow.expand();

        const MIN_LOADING_TIME = 1500;
        window.addEventListener('load', () => {
            const loadingScreen = document.getElementById('loading-screen');
            setTimeout(() => {
                loadingScreen.style.display = 'none';
            }, MIN_LOADING_TIME);
        });

        let score = 0;
        let upgradeCosts = [500, 2000, 4000, 5000];
        let coinValue = 1;
        let currentLevel = 1;
        const levels = [100, 300, 500, 800, 1000, 1500, 2500, 5000, 10000, 50000, 100000, 500000, 1000000];

        const scoreDisplay = document.getElementById('score');
        const upgScoreDisplay = document.getElementById('upgscore');
        const coin = document.getElementById('coin');
        const upgrades = document.querySelectorAll('.upgrade');
        const upgradeValues = [1, 2, 5, 8];
        const upgradeMultipliers = [2, 3, 3, 5];
        const upgradeImages = ['🚀', '🛸', '🌌', '🌠'];

        const currentLevelDisplay = document.getElementById('current-level');
        const nextLevelDisplay = document.getElementById('next-level');
        const progressBarFill = document.getElementById('progress-bar-fill');
        const progressText = document.getElementById('progress-text');

        const dailyBonus = document.getElementById('dailyBonus');
        const resetButton = document.getElementById('resetButton');
        const shareButton = document.getElementById('shareButton');

        let lightIntensity = 0;
        const maxLightIntensity = 1;
        const fadeInterval = 300; // Интервал утихания света в миллисекундах

        const lightEffect = document.createElement('div');
        lightEffect.id = 'light-effect';
        coin.appendChild(lightEffect);

        function updateLightEffect() {
            lightEffect.style.opacity = lightIntensity;
        }

        function fadeLightEffect() {
            if (lightIntensity > 0) {
                lightIntensity -= 0.1;
                if (lightIntensity < 0) {
                    lightIntensity = 0;
                }
                updateLightEffect();
            }
        }

        coin.addEventListener('click', () => {
            score += coinValue;
            tgwindow.expand();
            updateScore();
            updateLevel();
            showCoinEffect(coinValue);

            if (lightIntensity < maxLightIntensity) {
                lightIntensity += 0.1;
                if (lightIntensity > maxLightIntensity) {
                    lightIntensity = maxLightIntensity;
                }
                updateLightEffect();
            }

            clearInterval(fadeIntervalId);
            fadeIntervalId = setInterval(fadeLightEffect, fadeInterval);
        });

        let fadeIntervalId = setInterval(fadeLightEffect, fadeInterval);

        upgrades.forEach((upgrade, index) => {
            upgrade.addEventListener('click', () => {
                if (score >= upgradeCosts[index]) {
                    score -= upgradeCosts[index];
                    coinValue += upgradeValues[index];
                    upgradeCosts[index] *= upgradeMultipliers[index];
                    updateScore();
                    upgrade.innerHTML = `<span style="font-size: 50px;">${upgradeImages[index]}</span> Coins +${upgradeValues[index]} (Cost: ${upgradeCosts[index]})`;
                }
            });
        });

        function updateScore() {
            scoreDisplay.textContent = `Sparks: ${score}`;
            upgScoreDisplay.textContent = `Sparks: ${score}`;
            localStorage.setItem('lilikScore', score);
            localStorage.setItem('lilikCoinValue', coinValue);
            upgradeCosts.forEach((cost, index) => {
                localStorage.setItem(`lilikUpgrade${upgradeValues[index]}Cost`, cost);
            });
        }

        function updateLevel() {
            for (let i = 0; i < levels.length; i++) {
                if (score < levels[i]) {
                    currentLevel = i + 1;
                    break;
                }
            }
            currentLevelDisplay.textContent = currentLevel;
            nextLevelDisplay.textContent = currentLevel + 1;
            const progress = (score - (levels[currentLevel - 2] || 0)) / (levels[currentLevel - 1] - (levels[currentLevel - 2] || 0)) * 100;
            progressBarFill.style.width = `${progress}%`;
            progressText.textContent = `${Math.round(progress)}%`;
        }

        function loadScore() {
            const savedScore = localStorage.getItem('lilikScore');
            const savedCoinValue = localStorage.getItem('lilikCoinValue');
            const savedCurrentLevel = localStorage.getItem('lilikCurrentLevel');

            if (savedScore !== null) {
                score = parseInt(savedScore, 10);
            }
            if (savedCoinValue !== null) {
                coinValue = parseInt(savedCoinValue, 10);
            }
            if (savedCurrentLevel !== null) {
                currentLevel = parseInt(savedCurrentLevel, 10);
            }
            upgradeCosts.forEach((cost, index) => {
                const savedCost = localStorage.getItem(`lilikUpgrade${upgradeValues[index]}Cost`);
                if (savedCost !== null) {
                    upgradeCosts[index] = parseInt(savedCost, 10);
                }
            });

            updateScore();
            updateLevel();
            upgrades.forEach((upgrade, index) => {
                upgrade.innerHTML = `<span style="font-size: 50px;">${upgradeImages[index]}</span> Coins +${upgradeValues[index]} (Cost: ${upgradeCosts[index]})`;
            });
        }

        resetButton.addEventListener('click', () => {
            score = 0;
            coinValue = 1;
            upgradeCosts = [500, 2000, 4000, 5000];
            currentLevel = 1;
            updateScore();
            updateLevel();
            localStorage.clear();
        });

        dailyBonus.addEventListener('click', () => {
            const lastClaim = localStorage.getItem('lastDailyClaim');
            const today = new Date().toDateString();

            if (lastClaim !== today) {
                score += 1000;
                updateScore();
                localStorage.setItem('lastDailyClaim', today);
                alert('You claimed your daily bonus of 1000 sparks 💠');
            } else {
                alert('You have already claimed your daily bonus today 💠');
            }
        });

        // Навигация
        const navButtons = document.querySelectorAll('.nav-button');
        navButtons.forEach(button => {
            button.addEventListener('click', (event) => {
                event.preventDefault();
                const targetId = event.target.getAttribute('href').substring(1);
                document.querySelectorAll('.page').forEach(page => {
                    page.classList.remove('active');
                });
                document.getElementById(targetId).classList.add('active');
            });
        });

        function showCoinEffect(value) {
            const effect = document.createElement('div');
            effect.className = 'coin-effect';
            effect.textContent = `+${value}`;
            coin.appendChild(effect);
            setTimeout(() => {
                coin.removeChild(effect);
            }, 1000);
        }

        shareButton.addEventListener('click', () => {
            const shareText = `I have ${score} Lilik Sparks and I am at level ${currentLevel} in Lilik Combat! Join @LilikCombat_bot`;

            if (!navigator.share) {
                const telegramUrl = `https://t.me/share/url?url=${encodeURIComponent(shareText)}`;
                window.open(telegramUrl, '_blank');
            } else {
                navigator.share({
                    title: 'Lilik Combat',
                    text: shareText
                }).catch(error => console.error('Error sharing:', error));
            }
        });
        loadScore();
    </script>
</body>
</html>
